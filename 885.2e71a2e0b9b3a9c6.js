"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[885],{8349:(w,g,o)=>{o.d(g,{R:()=>O});var e=o(4769),p=o(6726),u=o(5544),d=o(6814),m=o(3714),h=o(707),_=o(7213),l=o(95),f=o(2186);const C=function(s){return{" disabled":s}};function v(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"div",19)(1,"div",20),e.NdJ("click",function(){const a=e.CHM(i).$implicit,c=e.oxw(2);return e.KtG(c.cardClick(a,"add"))}),e.TgZ(2,"div",21)(3,"div",22),e._uU(4),e.qZA(),e.TgZ(5,"div",23),e._uU(6),e.qZA()(),e.TgZ(7,"div",21)(8,"div",24),e._uU(9),e.qZA(),e.TgZ(10,"div",25),e._uU(11),e.qZA()()()()}if(2&s){const i=r.$implicit;e.Q6J("ngClass",e.VKq(5,C,0===i.quantite)),e.xp6(4),e.hij(" ",i.article.codeArticle," "),e.xp6(2),e.hij(" ",i.article.prixVenteTTC," TND "),e.xp6(3),e.hij(" ",i.article.designation," "),e.xp6(2),e.hij(" QG: ",i.quantite," ")}}function A(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"div",31)(1,"div",32)(2,"div",33)(3,"div",22),e._uU(4),e.qZA(),e.TgZ(5,"div",34),e._uU(6),e.qZA(),e.TgZ(7,"div",35),e._uU(8),e.qZA(),e.TgZ(9,"div",36)(10,"button",37),e.NdJ("click",function(){const a=e.CHM(i).$implicit,c=e.oxw(4);return e.KtG(c.cardClick(a,"moins"))}),e.qZA()()()()()}if(2&s){const i=r.$implicit;e.xp6(4),e.hij(" ",i.article.codeArticle," "),e.xp6(2),e.hij(" ",i.totalCommander," TND "),e.xp6(2),e.hij(" ",i.quantiteCommander," ")}}function x(s,r){if(1&s&&(e.TgZ(0,"div",30),e.YNc(1,A,11,3,"div",17),e.qZA()),2&s){const i=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",i.selectedItems.slice().reverse())}}function T(s,r){if(1&s&&(e.TgZ(0,"div",26)(1,"div",27)(2,"span",28),e._uU(3," Liste des Articles S\xe9lectionn\xe9s "),e.qZA()(),e.YNc(4,x,2,1,"div",29),e.qZA()),2&s){const i=e.oxw(2);e.xp6(4),e.Q6J("ngIf",!i.validateDiseabled)}}function L(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"div",31)(1,"div",32)(2,"div",33)(3,"div",22),e._uU(4),e.qZA(),e.TgZ(5,"div",34),e._uU(6),e.qZA(),e.TgZ(7,"div",35),e._uU(8),e.qZA(),e.TgZ(9,"div",36)(10,"button",37),e.NdJ("click",function(){const a=e.CHM(i).$implicit,c=e.oxw(2);return e.KtG(c.cardClick(a,"moins"))}),e.qZA()()()()()}if(2&s){const i=r.$implicit;e.xp6(4),e.hij(" ",i.article.codeArticle," "),e.xp6(2),e.hij(" ",i.totalCommander," TND "),e.xp6(2),e.hij(" ",i.quantiteCommander," ")}}function M(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"div",11)(1,"span",12)(2,"button",38),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n.confirmerCommande())}),e.qZA()()()}if(2&s){const i=e.oxw(2);e.xp6(2),e.Q6J("disabled",i.validateDiseabled)}}const b=function(){return{width:"90vw",height:"100vh"}},I=function(s){return{"limited-height-all":s}},Z=function(){return{width:"90vw",height:"60vh"}};function E(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"p-dialog",2),e.NdJ("visibleChange",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.dialog=n)})("onHide",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.onHide())}),e.TgZ(1,"div",3)(2,"div")(3,"span",4)(4,"input",5),e.NdJ("ngModelChange",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.searchTerm=n)})("ngModelChange",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.filterArticles())}),e.qZA(),e._UZ(5,"i",6),e.qZA(),e.TgZ(6,"button",7),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.search())}),e.qZA()()(),e.TgZ(7,"div",8),e.YNc(8,v,12,7,"div",9),e.qZA(),e.YNc(9,T,5,1,"div",10),e.TgZ(10,"div",11)(11,"span",12)(12,"button",13),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.ValiderArticle())}),e.qZA(),e.TgZ(13,"button",14),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.ShowClick())}),e.qZA()()(),e.TgZ(14,"p-dialog",15),e.NdJ("visibleChange",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.display=n)}),e._UZ(15,"div",16),e.YNc(16,L,11,3,"div",17),e.YNc(17,M,3,1,"div",18),e.qZA()()}if(2&s){const i=e.oxw();e.Akn(e.DdM(17,b)),e.Q6J("visible",i.dialog)("maximizable",!1)("modal",!0),e.xp6(4),e.Q6J("ngModel",i.searchTerm),e.xp6(3),e.Q6J("ngClass",e.VKq(18,I,i.validateDiseabled)),e.xp6(1),e.Q6J("ngForOf",i.filteredArticles),e.xp6(1),e.Q6J("ngIf",!i.validateDiseabled),e.xp6(3),e.Q6J("disabled",i.validateDiseabled),e.xp6(1),e.Q6J("disabled",i.validateDiseabled),e.xp6(1),e.Akn(e.DdM(20,Z)),e.Q6J("visible",i.display)("modal",!0),e.xp6(2),e.Q6J("ngForOf",i.selectedItems.slice().reverse()),e.xp6(1),e.Q6J("ngIf","val"===i.show)}}function P(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"app-codea-barre-scanner",39),e.NdJ("codeValue",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.valueChanged(n))}),e.qZA()}}let O=(()=>{var s;class r{constructor(t){this.articleService=t,this.dialog=!0,this.selectedItems=[],this.selectedItemsChange=new e.vpe,this.validateDiseabled=!0,this.searchTerm="",this.display=!1,this.codeLivreur="00",this.show="",this.showinSaisie=new e.vpe,this.ArticlesUpdated=new e.vpe,this.filteredArticles=[],this.scanner=!1}ngOnInit(){const t=localStorage.getItem("token"),n=(0,p.Z)(t);""!=n.CodeLivreur&&(this.codeLivreur=n.CodeLivreur),this.articleService.getListArticleCommande(this.codeLivreur).then(a=>{this.ListArticles=a,this.filterArticles(),0!=this.selectedItems.length&&this.updateListeArticle()})}filterArticles(){this.filteredArticles=this.ListArticles.filter(t=>{const n=t.article;return n.codeArticle.toLowerCase().includes(this.searchTerm.toLowerCase())||n.reference.toLowerCase().includes(this.searchTerm.toLowerCase())||n.codeCouleur.toLowerCase().includes(this.searchTerm.toLowerCase())||t.prixVenteTTC.toString().includes(this.searchTerm)})}updateListeArticle(){for(let t=0;t<this.selectedItems.length;t++){const n=this.selectedItems[t],a=this.filteredArticles.findIndex(c=>c.article.codeArticle===n.article.codeArticle);-1!==a&&(this.filteredArticles[a]=n),this.validateDiseabled=!1}}cardClick(t,n){const a=this.selectedItems.indexOf(t);-1===a?(t.quantiteCommander=1,t.totalCommander=this.roundSQL(t.prixVenteTTC*t.quantiteCommander,3),t.quantite-=1,this.selectedItems.push(t)):("add"===n?(t.quantite-=1,t.quantite>=0?t.quantiteCommander+=1:t.quantite=0):(t.quantiteCommander-=1,t.quantite+=1,0===t.quantiteCommander&&this.selectedItems.splice(a,1)),t.totalCommander=this.roundSQL(t.prixVenteTTC*t.quantiteCommander,3),this.filteredArticles.filter(c=>c.codeArticle===t.codeArticle)[0].isSelected=!1,0===this.selectedItems.length&&(this.display=!1,this.validateDiseabled=!0)),this.selectedItemsChange.emit(this.selectedItems),this.selectedItems.length>0&&(this.validateDiseabled=!1)}ValiderArticle(){this.commande={lignesCommande:[],totalCommande:0,quantiteTotal:0},this.commande.lignesCommande=this.selectedItems;for(let t=0;t<this.selectedItems.length;t++)this.commande.totalCommande+=this.selectedItems[t].totalCommander,this.commande.quantiteTotal+=this.selectedItems[t].quantiteCommander;this.ArticlesUpdated.emit(this.commande)}roundSQL(t,n){const a=Math.pow(10,n);return Math.round(t*a)/a}confirmerCommande(){this.commande={lignesCommande:[],totalCommande:0,quantiteTotal:0},this.commande.lignesCommande=this.selectedItems;for(let t=0;t<this.selectedItems.length;t++)this.commande.totalCommande+=this.selectedItems[t].totalCommander,this.commande.quantiteTotal+=this.selectedItems[t].quantiteCommander;this.ArticlesUpdated.emit(this.commande)}ShowClick(){this.display=!0,this.show="show"}onHide(){1!=this.scanner&&this.showinSaisie.emit(!1)}search(){this.scanner=!0,this.dialog=!1}valueChanged(t){this.searchTerm=t,this.filterArticles(),this.scanner=!1,this.dialog=!0}}return(s=r).\u0275fac=function(t){return new(t||s)(e.Y36(u.n))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-liste-article-commande"]],inputs:{dialog:"dialog",ListArticles:"ListArticles",selectedItems:"selectedItems"},outputs:{selectedItemsChange:"selectedItemsChange",showinSaisie:"showinSaisie",ArticlesUpdated:"ArticlesUpdated"},decls:3,vars:2,consts:[["header","Liste des Articles ","label","Show","class","p-fluid listeArticleCommande",3,"visible","style","maximizable","modal","visibleChange","onHide",4,"ngIf"],[3,"codeValue",4,"ngIf"],["header","Liste des Articles ","label","Show",1,"p-fluid","listeArticleCommande",3,"visible","maximizable","modal","visibleChange","onHide"],[1,"col-12",2,"display","flex","justify-content","space-around"],[1,"p-input-icon-left","p-input-icon-right"],["type","text","pInputText","","placeholder","Search",3,"ngModel","ngModelChange"],[1,"pi","pi-search"],["pButton","","pRipple","","icon","pi pi-qrcode",1,"p-button-outlined","p-button-info",3,"click"],[1,"card","limited-height",2,"background-color","#eff3f8",3,"ngClass"],["class","cart-item field",3,"ngClass",4,"ngFor","ngForOf"],["class","card limited",4,"ngIf"],[1,"cart-button",2,"justify-content","center"],[1,"p-buttonset"],["pButton","","pRipple","","label","Valider","icon","pi pi-check",3,"disabled","click"],["pButton","","icon","pi pi-external-link","label","Show",1,"mr-10",3,"disabled","click"],["header","Liste des articles s\xe9lectionn\xe9s","showEffect","fade",3,"visible","modal","visibleChange"],[1,"mt-3"],["class","cart-item field",4,"ngFor","ngForOf"],["class","cart-button","style","justify-content: center; ",4,"ngIf"],[1,"cart-item","field",3,"ngClass"],[1,"card",3,"click"],[1,"flex",2,"display","flex","justify-content","space-between"],[1,"p-field","p-col-12","p-md-8","designation",2,"font-size","16","font-weight","500"],[1,"p-field","p-col-12","p-md-2","amount",2,"font-size","16","font-weight","500","color","#6b0505"],[1,"p-field","p-col-12","p-md-8","designation",2,"font-size","16","font-weight","900"],[1,"p-field","p-col-12","p-md-2","amount",2,"font-weight","700"],[1,"card","limited"],[2,"margin-top","-11px","margin-bottom","0px","height","3vh","text-align","center"],[2,"text-align","center","font-weight","800","color","rgb(4, 4, 99)","font-size","16px","font-family","'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"],["class","card limited-show-height","style","background-color: #e8f0fa;",4,"ngIf"],[1,"card","limited-show-height",2,"background-color","#e8f0fa"],[1,"cart-item","field"],[1,"card",2,"padding","0.5rem"],[1,"flex",2,"display","flex","justify-content","space-between","margin-top","1px","margin-bottom","-11px"],[1,"p-field","p-col-12","p-md-2","amount",2,"font-size","13","font-weight","400"],[1,"p-field","p-col-12","p-md-2","amount",2,"font-size","16","font-weight","800"],[1,"p-field","p-col-12","p-md-2","amount",2,"margin-top","-10px"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-rounded","p-button-danger","p-button-text",3,"click"],["pButton","","pRipple","","label","Confirmer","icon","pi pi-check",3,"disabled","click"],[3,"codeValue"]],template:function(t,n){1&t&&(e.TgZ(0,"div"),e.YNc(1,E,18,21,"p-dialog",0),e.YNc(2,P,1,0,"app-codea-barre-scanner",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!n.scanner),e.xp6(1),e.Q6J("ngIf",n.scanner))},dependencies:[d.mk,d.sg,d.O5,m.o,h.Hq,_.V,l.Fj,l.JJ,l.On,f.i],styles:['@charset "UTF-8";.card[_ngcontent-%COMP%]{padding:.5rem;margin-top:-5px}.card-selected[_ngcontent-%COMP%]{box-shadow:0 4px 8px #0000001a;transform:translateY(-5px);padding:1.5rem}.cart-button[_ngcontent-%COMP%]{position:fixed;bottom:0;background-color:#424045;color:#fff;width:100%;height:50px;right:0;left:0;justify-content:center;align-items:center;font-size:16px;cursor:pointer;box-shadow:0 2px 10px #0000001a;transition:background-color .3s ease;display:flex;justify-content:space-between;padding:0 5%;transition:all .3s ease}  .p-dialog-draggable .p-dialog-header{cursor:move;padding:.5rem}.limited-height[_ngcontent-%COMP%]{height:43vh;overflow-y:auto}.limited-show-height[_ngcontent-%COMP%]{height:20vh;overflow-y:auto;padding:9px}.limited-height-all[_ngcontent-%COMP%]{height:80vh;overflow-y:auto}.p-dialog-content[_ngcontent-%COMP%]{background-color:#eff3f8}.limited[_ngcontent-%COMP%]{height:25vh;margin-top:-1vh}  .p-dialog .p-dialog-content{background:#ffffff;color:#495057;padding:0 1rem 2rem}.disabled[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}']}),r})()},3885:(w,g,o)=>{o.r(g),o.d(g,{ListeArticleCommandeModule:()=>t});var e=o(6814),p=o(2129),u=o(8349),d=o(4769);let h=(()=>{var n;class a{}return(n=a).\u0275fac=function(D){return new(D||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[p.Bz.forChild([{component:u.R,path:""}]),p.Bz]}),a})();var _=o(4237),l=o(8981),f=o(1825),C=o(3714),v=o(3965),A=o(6022),x=o(707),T=o(7327),L=o(7213),M=o(5389),b=o(7161),I=o(4104),Z=o(9502),E=o(8608),P=o(95),O=o(5359),s=o(5043),r=o(9445),i=o(771);let t=(()=>{var n;class a{}return(n=a).\u0275fac=function(D){return new(D||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[e.ez,h,_.FI,l.f,f.C,C.j,v.kW,A.Xt,T.WN,x.hJ,L.S,M.fx,b.O,Z.$,I.EV,E.TX,P.u5,O.x,s.t,r.Q,i.CodeaBarreScannerModule]}),a})()},5544:(w,g,o)=>{o.d(g,{n:()=>d});var e=o(553),p=o(4769),u=o(9862);let d=(()=>{var m;class h{constructor(l){this.http=l,this.urlApi=e.N.urlApi}getArticles(){return this.http.get(this.urlApi+"Articles").toPromise()}getListArticleCommande(l){return this.http.get(this.urlApi+"Articles/listArticleCommander/"+l).toPromise()}getPaarametreDiversTaux(){return this.http.get(this.urlApi+"ParametreDivers/Utilities").toPromise()}getAllTva(){return this.http.get(this.urlApi+"Tvas").toPromise()}postBonCommandeVente(l){return this.http.post(this.urlApi+"BonCommandeVentes",l).toPromise()}getReglementClient(l){return this.http.post(`${this.urlApi}Articles/piecesNonPayees`,l).toPromise()}getFamilleArticle(l){return this.http.get(this.urlApi+"FamilleArticles/"+l).toPromise()}getMarqueArticle(l){return this.http.get(this.urlApi+"MarqueArticles/"+l).toPromise()}}return(m=h).\u0275fac=function(l){return new(l||m)(p.LFG(u.eN))},m.\u0275prov=p.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),h})()}}]);